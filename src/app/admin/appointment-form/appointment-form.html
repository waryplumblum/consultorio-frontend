<div class="appointment-form-container">
  <h2>{{ isEditMode ? 'Editar Cita' : 'Crear Nueva Cita' }}</h2>

  <form [formGroup]="appointmentForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="patientName">Nombre del Paciente:</label>
      <input type="text" id="patientName" formControlName="patientName">
      <div *ngIf="getControlErrorMessage('patientName')" class="error-message">
        {{ getControlErrorMessage('patientName') }}
      </div>
    </div>

    <div class="form-group">
      <label for="patientPhone">Tel√©fono del Paciente:</label>
      <input type="tel" id="patientPhone" formControlName="patientPhone">
      <div *ngIf="getControlErrorMessage('patientPhone')" class="error-message">
        {{ getControlErrorMessage('patientPhone') }}
      </div>
    </div>

    <div class="form-group">
      <label for="patientEmail">Email del Paciente:</label>
      <input type="email" id="patientEmail" formControlName="patientEmail">
      <div *ngIf="getControlErrorMessage('patientEmail')" class="error-message">
        {{ getControlErrorMessage('patientEmail') }}
      </div>
    </div>

    <div class="form-group">
      <label for="reason">Motivo de la Cita:</label>
      <textarea id="reason" formControlName="reason" rows="3"></textarea>
      <div *ngIf="getControlErrorMessage('reason')" class="error-message">
        {{ getControlErrorMessage('reason') }}
      </div>
    </div>

    <div class="form-group">
      <label for="preferredDate">Fecha Preferida:</label>
      <input type="date" id="preferredDate" formControlName="preferredDate">
      <div *ngIf="getControlErrorMessage('preferredDate')" class="error-message">
        {{ getControlErrorMessage('preferredDate') }}
      </div>
    </div>

    <div class="form-group">
      <label for="preferredTime">Hora Preferida:</label>
      <input type="time" id="preferredTime" formControlName="preferredTime">
      <div *ngIf="getControlErrorMessage('preferredTime')" class="error-message">
        {{ getControlErrorMessage('preferredTime') }}
      </div>
    </div>

    <div class="form-group">
      <label for="status">Estado de la Cita:</label>
      <select id="status" formControlName="status">
        <option *ngFor="let status of statusOptions" [value]="status">{{ status | titlecase }}</option>
      </select>
      <div *ngIf="getControlErrorMessage('status')" class="error-message">
        {{ getControlErrorMessage('status') }}
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-primary" [disabled]="loading">
        {{ loading ? 'Guardando...' : (isEditMode ? 'Actualizar Cita' : 'Crear Cita') }}
      </button>
      <button type="button" class="btn btn-secondary" (click)="onCancel()">Cancelar</button>
    </div>

    <div *ngIf="submitMessage" class="submit-success-message">
      {{ submitMessage }}
    </div>
    <div *ngIf="errorMessage && !submitMessage" class="submit-error-message">
      {{ errorMessage }}
    </div>
  </form>
</div>